import{d as C,r as v,c as b,a as e,t as p,n as $,o as h,p as w,b as S,_ as k,e as m,H as P,f as B,g as y,F as I,h as N,i as x}from"./index-Cg-Bl1zD.js";const j=i=>(w("data-v-7146a267"),i=i(),S(),i),H={class:"header"},z=j(()=>e("h1",null,"Messages",-1)),R={class:"pagination-wrapper"},T={class:"btn-search-wrapper"},V=C({__name:"MessagesHeader",props:{page:{type:Number,required:!0}},emits:["statusChanged","paginate"],setup(i,{emit:n}){const o=v("pending"),d=n,c=a=>{o.value=a},l=a=>{d("paginate",a)};return(a,s)=>(h(),b("div",H,[z,e("div",R,[e("button",{onClick:s[0]||(s[0]=u=>l(-1)),class:"btn"},"Prev Page"),e("div",null,[e("span",null,p(a.$props.page),1)]),e("button",{onClick:s[1]||(s[1]=u=>l(1)),class:"btn"},"Next Page")]),e("div",T,[e("button",{class:$(["btn",{active:o.value==="pending"}]),onClick:s[2]||(s[2]=u=>{c("pending"),d("statusChanged",!1)})},"Pending",2),e("button",{class:$(["btn",{active:o.value==="is_read"}]),onClick:s[3]||(s[3]=u=>{c("is_read"),d("statusChanged",!0)})},"Read ",2)])]))}}),q=k(V,[["__scopeId","data-v-7146a267"]]),_=i=>(w("data-v-457f3d60"),i=i(),S(),i),A={class:"card"},E={class:"info"},F={class:"header"},L={class:"btns-wrapper"},D=_(()=>e("h3",null,"Personal Info:",-1)),G=_(()=>e("strong",null,"Name: ",-1)),O=_(()=>e("strong",null,"Phone: ",-1)),J=_(()=>e("strong",null,"Email: ",-1)),K=_(()=>e("h3",null,"Message Info:",-1)),Q=_(()=>e("strong",null,"Subject: ",-1)),U=_(()=>e("strong",null,"Message: ",-1)),W=C({__name:"MessageCard",props:{message:{type:Object,required:!0}},setup(i){var c;const n=i,o=v((c=n.message)==null?void 0:c.is_read),d=async l=>{var u;if(o.value===l)return;let a;l===1?a="true":a="false";const s=await P.put(`admin/message/${(u=n.message)==null?void 0:u.id}/${a}`,{status:l},{Authorization:`Bearer ${localStorage.getItem("token")}`});if(console.log(s),s.status===401&&(window.location.href="/login"),s.status===200)return o.value=l,s.data;alert(s.data.error)};return(l,a)=>{var s,u,f,t,g,r;return h(),b("div",A,[e("div",E,[e("div",F,[e("h2",null,p((s=n.message)==null?void 0:s.subject),1),e("div",L,[e("button",{class:$([{active:n.message.is_read==1},"btn"]),onClick:a[0]||(a[0]=M=>d(1))},"Read",2),e("button",{class:$([{active:n.message.is_read==0},"btn"]),onClick:a[1]||(a[1]=M=>d(0))},"Not Read",2)])]),D,e("p",null,[G,m(p((u=n.message)==null?void 0:u.name),1)]),e("p",null,[O,m(p((f=n.message)==null?void 0:f.phone),1)]),e("p",null,[J,m(p((t=n.message)==null?void 0:t.email),1)]),K,e("p",null,[Q,m(" "+p((g=n.message)==null?void 0:g.subject),1)]),e("p",null,[U,m(" "+p((r=n.message)==null?void 0:r.message),1)])])])}}}),X=k(W,[["__scopeId","data-v-457f3d60"]]),Y={class:"reservations-container"},Z=C({__name:"Messages",setup(i){const n=v([]),o=v(1),d=v(0),c=v(!1),l=async()=>{console.log("getMessages",c.value);const t=await P.get(`admin/message/${c.value}?page=${o.value}`,{Authorization:`Bearer ${localStorage.getItem("token")}`});if(n.value=t.data.data,d.value=t.data.last_page,t.status===401){window.location.href="/login";return}if(t.status===200)return t.data;console.error(t),alert(t)},a=t=>{o.value==1&&t<0||o.value==d.value&&t>0||(o.value=o.value+t,f())},s=t=>{c.value=t,o.value=1,l()},f=((t,g=300)=>{let r;return function(...M){clearTimeout(r),r=setTimeout(()=>t.apply(this,M),g)}})(l,300);return B(()=>{l()}),(t,g)=>(h(),b(I,null,[y(q,{page:o.value,onPaginate:g[0]||(g[0]=r=>a(r)),onStatusChanged:g[1]||(g[1]=r=>s(r))},null,8,["page"]),e("div",Y,[(h(!0),b(I,null,N(n.value,r=>(h(),x(X,{class:"reservation",message:r,key:r.id},null,8,["message"]))),128))])],64))}}),se=k(Z,[["__scopeId","data-v-7814bd75"]]);export{se as default};
